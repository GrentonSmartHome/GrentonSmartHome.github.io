<!DOCTYPE html><html lang="pl"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="author" content="Grenton Sp. z o. o."/><title>Grenton Downloads</title><meta name="twitter:title" content="Grenton Downloads"/><meta name="og:title" content="Grenton Downloads"/><link href="/styles.css" rel="stylesheet"/><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous"/></head><body class="bg-light"><nav class="navbar navbar-expand-lg fixed-top navbar-dark bg-dark" aria-label="Main navigation"><div class="container-fluid"><a class="navbar-brand" href="/release-pl"><img class="glogo" src="/images/logo.svg" alt="logo-grenton" height="18"/></a><span><a style="text-decoration: none;font-size: .835rem; color:#ffffff!important;" href="/beta-en/smartpanelv6-new-functionality"><img style="margin-bottom: 3px;" height="16px" src="/images/english.png"/>&nbsp;English</a></span></div></nav><div class="nav-scroller bg-white shadow-sm"><nav class="nav nav-underline" aria-label="Secondary navigation"><a class="nav-link active" aria-current="page" href="/beta-pl">&larr; Powrót</a></nav></div><main class="container"><div class="d-flex align-items-center p-3 my-3 text-white bg-purple rounded shadow-sm"><div class="lh-1"><h1 class="h6 mb-0 text-white lh-1">Konfiguracja modułu Smart Panel w wersji v6</h1><small>Instrukcja</small></div></div><div class="alert alert-warning" role="alert"><small><b class="uwaga">UWAGA!</b><br>Smart Panel w wersji v6 dostępny jest dla Object Managera w wersji 1.4.1 i wyższej oraz dla CLU Z-Wave z firmware 5.08.01 i wyższym.</small></div><h5>Parametry konfiguracyjne</h5><p>W najnowszej wersji modułu Smart Panel v6 zostały wprowadzone nowe parametry konfiguracyjne dla takich obiektów jak:</p><ul><li>PANEL,</li><li>PANEL_PAGE,</li><li>PANELSENSTEMP.</li></ul><p>Pełną listę zmian wprowadzonych w wersji V6 można znaleźć w release notes danej wersji: <a href="/beta-pl/smartpanel/">Release Notes - moduł Smart Panel</a></p><h5>Nowa funkcjonalność</h5><h6>A. Mechanizm informowania o błędnej konfiguracji / przejściu w tryb Rozproszonej Logiki</h6><p>Nową funkcjonalnością wprowadzoną wraz z wersją v6 jest mechanizm informowania użytkownika o błędnej konfiguracji lub przejścia w tryb Rozproszonej Logiki. Mechanizm ten polega na tym, iż moduł oczekuje około 10 sekund na otrzymanie konfiguracji po jej wysłaniu lub restarcie systemu. Po tym czasie kończy się okres oczekiwania na konfigurację, a użytkownik zostanie poinformowany o błędnej konfiguracji lub przejściu w tryb Rozproszonej Logiki poprzez jeden, krótki i niski dźwięk.<br><br>##### B. Tryb Rozproszonej Logiki</p><p>Kolejną funkcjonalnością dodaną do najnowszej wersji modułu Smart Panel jest tryb Rozproszonej Logiki. Jest on dostępny od wersji 6.1.8-2115 i wyższej. Szczegółowe informacje na temat konfiguracji oraz sposobu działania Rozproszonej Logiki - <a href="#XIX. Rozproszenie Logiki Grenton 2.0">patrz XIX.</a></p><h5>Zmiana UI oraz mechanizmu działania stron typu Thermostats</h5><p>Moduł Smart Panel w wersji v6 oferuje odświeżony UI strony typu Thermostats, a także nowe funkcje. Sposób tworzenia i konfiguracji strony z wykorzystaniem obiektów typu Thermostats jest taki sam jak dla poprzednich wersji - <a href="#5.9. Tworzenie konfiguracji z wykorzystaniem obiektu strony Thermostats">patrz - XII.5.9.</a></p><h5>A. Zmiana UI termostatu</h5><p>Poniższy schemat przedstawia poglądowy wygląd odświeżonego termostatu na ekranie Smart Panelu. Zmianie uległo kilka elementów:</p><ul><li>wprowadzenie ikony w lewym górnym rogu - domyślnie wyświetlana jest ikona "chmode", która znajduje się na karcie SD (ikona została przedstawiona na schemacie). Jednakże w przypadku braku niniejszej ikony na karcie SD, zostanie wyświetlony napis "mode". Dodatkowo użytkownik może wprowadzić własną ikonę za pośrednictwem metody <code>SetObject_X_CustomIcon</code> lub też cechy wbudowanej <code>Object_X_CustomIcon</code>,</li><li>za pośrednictwem strzałki użytkownik może przejść do kolejnego termostatu na stronie (krótkie naciśniecie przycisku w przypadku więcej niż jednego termostatu na stronie) lub przejść do następnej strony (krótkie naciśnięcie w przypadku jednego termostatu na stronie, dłuższe przytrzymanie przycisku w przypadku więcej niż jednego termostatu na stronie),</li><li>przy strzałce zostały wprowadzone kropki, które sygnalizują numer termostatu obecnie wyświetlanego (jedna kropka - Object<em>1</em>Id, dwie kropki - Object<em>2</em>Id, itd.). W przypadku kiedy na stronie jest tylko i wyłącznie jeden termostat, kropki nie są wyświetlane,</li><li>za pomocą "-" / "+" istnieje możliwość zmiany zadanej temperatury oraz trybu działania termostatu z Auto na Manual,</li><li>dłuższe przytrzymanie lewego górnego przycisku (w dalszej części zwanego 'mode') powoduje wyłączenie / włączenie termostatu lub zmianę z trybu Manual na tryb Auto,</li><li>w przypadku kiedy termostat jest wyłączony, to znika zadana temperatura, a pojawia się napis "Off", który usytuowany jest centralnie,</li><li>zmianie uległo również wyświetlanie temperatury odczytanej ze źródła - obecnie większą czcionką wyświetlany jest wartość temperatury przed przecinkiem, natomiast mniejszą wartość po przecinku oraz jednostka. Dodatkowo wyświetlanie tej temperatury jest zależne od wielkości wprowadzonej ikony - więcej na ten temat w kolejnym podpunkcie. <br/></li></ul><img src="/images/images-pl/SMARTPANEL_CONFIG_V6_TYPE_THERMOSTATS_1.JPG" style="width:500px; margin:auto"><br/>

#####  B. Nowe funkcje na stronie typu Thermostats

Od wersji v6 modułu Smart Panel dostępne są nowe funkcjonalności na stronie typu Thermostats. Jest to związane z wprowadzonymi zmianami w obrębie UI termostatu.

1. **Możliwość ustawiania własnych ikon**

   Pierwszą nową funkcjonalnością jest wspomniana wcześniej możliwość ustawiania własnych ikon przez użytkownika w lewym górnym narożniku wyświetlacza. Ich zmiana jest możliwa zarówno poprzez metodę `SetObject_X_CustomIcon` jak również poprzez cechę wbudowaną `Object_X_CustomIcon`. Szerokość wprowadzonej ikony ma wpływ na współrzędną "x" aktualnej temperatury. Dopuszczalne są ikony o wymiarach 64 x 32 piksele. W przypadku przekroczenia szerokości ikony x > 64, na wyświetlaczu zostanie narysowana wyłącznie sama ikona - UI termostatu nie będzie wyświetlany - jest to tak zwany tryb "big icon". Aby powrócić do wyświetlania interfejsu związanego z termostatem, należy ustawić ikonę, której szerokość nie przekracza 64 pikseli.

2. **Możliwość przypisania akcji pod nowe zdarzenia**

   Następną funkcjonalnością wprowadzoną w nowej wersji modułu jest możliwość przypisywania akcji pod nowe zdarzenia `OnThermXModeButtonClick`, gdzie X oznacza numer termostatu na stronie. Zdarzenie to jest generowane w momencie kliknięcia w przycisk 'mode' (lewy, górny przycisk).
<br/>

<img src="//images/images-pl/SMARTPANEL_CONFIG_V6_TYPE_THERMOSTATS_2.JPG" style="width:600px; margin:auto"><br/>

3. **Przykład konfiguracji nowych funkcjonalności**

   1. Konfiguracja lokalnego termostatu wraz ze zmianą pracy (grzanie / chłodzenie)

      Do stworzenia niniejszej konfiguracji wykorzystane są takie obiekty jak:

      - obiekt wirtualny Thermostat,
      - obiekt DOUT1 (np. modułu Relay) - odpowiedzialny za załączanie grzania / chłodzenia - wykorzystany w obiekcie wirtualnym Thermostat,
      - obiekt DOUT2 (np. modułu Relay) - selekcja co ma zostać załączone: grzanie czy chłodzenie - wykorzystany w skryptach.

      Na poniższym zrzucie ekranu przedstawiona została konfiguracja obiektu PANEL_PAGE oraz obiektu wirtualnego Thermostat w domyślnym ustawieniu, czyli grzaniu.
<br/>
<img src="/images/images-pl/SMARTPANEL_CONFIG_V6_TYPE_THERMOSTATS_3.JPG" style="width:600px; margin:auto"><br/>

<img src="/images/images-pl/SMARTPANEL_CONFIG_V6_TYPE_THERMOSTATS_4.JPG" style="width:600px; margin:auto"><br/>

      Konfiguracja zdarzenia OnTherm1ModeButtonClick:
<br/>
<img src="/images/images-pl/SMARTPANEL_CONFIG_V6_TYPE_THERMOSTATS_5.JPG" style="width:600px; margin:auto"><br/>

      Skrypt *skrypt_zmiana_trybu()* dokonujący zmiany trybu pracy termostatu z grzania na chłodzenie i na odwrót:
<br/>
<img src="/images/images-pl/SMARTPANEL_CONFIG_V6_TYPE_THERMOSTATS_6.JPG" style="width:600px; margin:auto"><br/>

      Powyższy skrypt w wersji tekstowej:
    
      ```lua
      if(CLU221000454->Termostat->ControlDirection==0) thenCLU221000454->skrypt_chlodzenie()elseCLU221000454->skrypt_grzanie()end
      ```
    
      Skrypt *skrypt_grzanie()* służący do zmiany cechy ControlDirection na wartość odpowiedzialną za grzanie, a także zmianę ikony i selekcję grzanie/chłodzenie:
    
      ```lua
      CLU221000454->Termostat->SetControlDirection(0)CLU221000454->x201000007_DOUT2->SwitchOff(0)CLU221000454->x250002161_PANEL_PAGE1->SetObject_1_CustomIcon("sun")
      ```
<br/>
<img src="/images/images-pl/SMARTPANEL_CONFIG_V6_TYPE_THERMOSTATS_7.JPG" style="width:400px; margin:auto"><br/>

      Skrypt *skrypt_chlodzenie()* służący do zmiany cechy ControlDirection na wartość odpowiedzialną za chłodzenie, a także zmianę ikony i selekcję grzanie/chłodzenie:
    
      ```lua
      CLU221000454->Termostat->SetControlDirection(1)CLU221000454->x201000007_DOUT2->SwitchOff(1)CLU221000454->x250002161_PANEL_PAGE1->SetObject_1_CustomIcon("cold")
      ```
<br/>
<img src="/images/images-pl/SMARTPANEL_CONFIG_V6_TYPE_THERMOSTATS_8.JPG" style="width:400px; margin:auto"><br/>

​      

###### C. Predefiniowane zachowanie przycisków

| Przycisk    | Krótkie/długie przyciśnięcie       | Opis zachowania                                              |
| ----------- | ---------------------------------- | ------------------------------------------------------------ |
| Lewy górny  | Krótkie naciśnięcie (kliknięcie)   | Wygenerowanie zdarzenia OnThermXModeButtonClick, gdzie X to numer termostatu na stronie |
| Lewy górny  | Długie naciśnięcie (przytrzymanie) | Zmiana stanu termostatu: Off/On. Dodatkowo umożliwia przejście z trybu Manual na tryb Auto |
| Prawy górny | Krótkie naciśnięcie (kliknięcie)   | Przejście do następnego termostatu na stronie w przypadku więcej niż jednego termostatu na stronie<br />Przejście do następnej strony w przypadku, kiedy na danej stronie jest tylko i wyłącznie jeden termostat |
| Prawy górny | Długie naciśnięcie (przytrzymanie) | Przejście do następnej strony                                |
| Lewy dolny  | Krótkie naciśnięcie (kliknięcie)   | Zmniejszenie temperatury zadanej (`PointValue`) o 0.1°C, a także zmiana trybu pracy z Auto na Manual |
| Lewy dolny  | Długie naciśnięcie (przytrzymanie) | Zmniejszenie temperatury zadanej (`PointValue`) - dopóki przycisk jest przytrzymany, a także zmiana trybu pracy z Auto na Manual |
| Prawy dolny | Krótkie naciśnięcie (kliknięcie)   | Zwiększenie temperatury zadanej (`PointValue`) o 0.1 °C, a także zmiana trybu pracy z Auto na Manual |
| Prawy dolny | Długie naciśnięcie (przytrzymanie) | Zwiększenie temperatury zadanej (`PointValue`) - dopóki przycisk jest przytrzymany, a także zmiana trybu pracy z Auto na Manual |



#### Konfiguracja trybu Rozproszenia Logiki

> **UWAGA!** 
> Moduł Smart Panel przy pierwszym podłączeniu do magistrali ma załączony tryb Rozproszenia Logiki - wartość 1 cech `DistributedLogicGroup_1 - DistributedLogicGroup_4` (Default Mode) - przypisana jest do czterech fizycznych przycisków - wejścia mogą sterować wyjściami, co zostało opisane poniżej. Po wykonaniu CLU Discovery i wysłaniu konfiguracji, następuje wyłączenie trybu. 

######  Konfiguracja trybu dla modułu Smart Panel

<img  src="/images/images-pl/DISTRIBUTED_LOGIC_2.png" style="width:600px; margin:auto"><br/>

W przypadku modułu Smart Panel powiązanie po stronie wejścia odbywa się w obiekcie `PANEL_PAGEx`. Wcześniej należy powiązać obiekty `PANEL_PAGEx` z odpowiednimi obiektami `PANEL_BUTTONx` poprzez ustawienie odpowiednich wartości cech `Object_x_Id`. W przypadku braku połączenia z CLU, w ustawionym trybie Logiki Rozproszonej mogą działać wszystkie 16 przycisków wraz ze zmianą stron za pomocą gestów.

> **UWAGA!** 
> Działanie Logiki Rozproszonej możliwe jest tylko w trybie `Buttons` obiektu `PANEL_PAGEx`.



##### Działanie Logiki Rozproszonej pomiędzy obiektami PANEL_PAGE z przypisanymi PANEL_BUTTON oraz wyjściowymi

> **UWAGA!** 
> Zdarzenia oraz wywoływane akcje są ustawione statycznie i nie ma możliwości ich zmiany.

Dostępne akcje podczas działania w trybie Rozproszenia Logiki:

###### A. Obiekt PANEL_PAGE z ustawionym obiektem PANEL_BUTTON oraz DOUT

* Naciśnięcie i przytrzymanie przycisku (SwitchOn) --> Załączenie danego wyjścia DOUT.
* Zwolnienie przycisku (SwitchOff) --> Wyłączenie danego wyjścia  DOUT.
* Krótkie naciśnięcie przycisku (Click) --> Zmiana stanu na przeciwny  DOUT. 

###### B. Obiekt PANEL_PAGE z ustawionym obiektem PANEL_BUTTON oraz DIMM

* Naciśnięcie i przytrzymanie przycisku (SwitchOn) --> Załączenie danego wyjścia DIMM .
* Zwolnienie przycisku (SwitchOff) --> Wyłączenie danego wyjścia DIMM .
* Krótkie naciśnięcie przycisku (Click) --> Zmiana stanu na przeciwny danego wyjścia DIMM. 

###### C. Obiekt PANEL_PAGE z ustawionym obiektem PANEL_BUTTON oraz LEDRGBW

* Naciśnięcie i przytrzymanie przycisku (SwitchOn) --> Załączenie danego kanału LEDRGBW.
* Zwolnienie przycisku (SwitchOff) -->  Wyłączenie danego kanału LEDRGBW.
* Krótkie naciśnięcie przycisku (Click) --> Zmiana stanu na przeciwny danego kanału LEDRGBW.

###### D. Obiekt PANEL_PAGE z ustawionym obiektem PANEL_BUTTON oraz ROLLER_SHUTTER

* Naciśnięcie i przytrzymanie przycisku (SwitchOn) --> Załączenie przekaźnika UP lub DOWN ROLLER_SHUTTER w zależności od poprzedniego kierunku jazdy.
* Zwolnienie przycisku (SwitchOff) --> Wyłączenie danego załączonego przekaźnika (UP lub DOWN).
* Krótkie naciśnięcie przycisku (Click) --> Zmiana stanu na przeciwny ROLLER_SHUTTER:
  * jeśli przekaźniki są wyłączone - załączenie przekaźnika UP lub DOWN, w zależności od poprzedniego kierunku jazdy,
  * jeśli przekaźnik UP lub DOWN jest załączony - wyłączenie przekaźnika.

> **UWAGA!** 
> Załączenie przekaźnika UP lub DOWN jest załączeniem przekaźnika bez wyłączenia po upłynięciu czasu MaxTime. Przekaźniki należy wyłączyć danym wejściem sterującym obiektem ROLLER_SHUTTER w trybie Rozproszonej Logiki.



####  Default Mode

W przypadku, gdy do danego obiektu wartość cechy `DistributedLogicGroup` ustawiona jest na wartość 1, działa on w trybie **Default Mode**. Jest to specjalny  tryb działania, domyślnie ustawiany dla każdego obiektu.

> **UWAGA!** 
> Zdarzenia oraz wywoływane akcje są ustawione statycznie i nie ma możliwości ich zmiany.

##### Default Mode dla modułów wejściowych oraz modułów wyjściowych

- moduł Smart Panel - steruje wszystkimi modułami wyjściowymi (RELAY 4HP DIN, RELAY 2HP DIN, DIMMER MOSFET DIN, ROLLER SHUTTER DIN) w sieci TFBUS będącymi również w Default Mode, przykładowo:
  - SMART PANEL PANEL_PAGE1 cecha DistributedLogicGroup_1 --> RELAY 4HP OUT1 | RELAY 2HP OUT1 | DIMMER MOSFET DIMM1 | ROLLER_SHUTTER1.
  - SMART PANEL PANEL_PAGE1 cecha DistributedLogicGroup_2 --> RELAY 4HP OUT2 | RELAY 2HP OUT2 | ROLLER_SHUTTER2.
  - SMART PANEL PANEL_PAGE1 cecha DistributedLogicGroup_3 --> RELAY 4HP OUT3 | ROLLER_SHUTTER3.
  - SMART PANEL PANEL_PAGE1 cecha DistributedLogicGroup_4 --> RELAY 4HP OUT4.

> **UWAGA!** 
> Załączenie przekaźnika UP lub DOWN jest załączeniem przekaźnika bez wyłączenia po upłynięciu czasu MaxTime. Przekaźniki należy wyłączyć danym wejściem sterującym Roller Shutterem w trybie Rozproszonej Logiki.

> **UWAGA!**
>
> Dla modułu Smart Panel działającego w Default Mode Logiki Rozproszonej zachowanie opisane powyżej jest identyczne dla każdego obiektu PANEL_PAGE (PANEL_PAGE1 - PANEL_PAGE4).

##### 2.2. Default Mode dla modułów posiadających własne wejścia / wyjścia

- moduł posiadający wejścia oraz wyjścia (I/O MODULE DIN 8, I/O MODULE FM, ROLLER SHUTTER FM)  - steruje własnymi kanałami o adekwatnym numerze (IN1->OUT1, IN2->OUT2, itd), przykładowo:

  - I/O MODULE FM IN1 --> I/O MODULE FM OUT1.
  - I/O MODULE FM IN2 --> I/O MODULE FM OUT2.
  - ROLLER SHUTTER FM IN1 --> ROLLER_SHUTTER1.

- moduł LED RGBW FM - steruje własnymi kanałami (Red, Green):

  - LED RGBW FM IN1 --> LED RGBW FM kanał R.
  - LED RGBW FM IN2 --> LED RGBW FM kanał G.

  


#### 3. Przywrócenie komunikacji pomiędzy CLU a modułem

W momencie, gdy komunikacja pomiędzy CLU a modułami zostanie przywrócona, wartość cech Value danych obiektów zostaje zaktualizowana do rzeczywistej wartości wejść / wyjść (na wartość zmienioną podczas działania trybu Rozproszenia Logiki), a moduły wykonują działania zgodnie z zaprogramowaną logiką na CLU. 

<nav class="navbar navbar-light bg-light gfooter"><div class="container-fluid"><span class="navbar-text"><small>&copy; 2021 Grenton Sp. z o. o.</small></span></div></nav></main></body></html>